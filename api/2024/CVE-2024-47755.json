{
  "id": "CVE-2024-47755",
  "sourceIdentifier": "416baaa9-dc9f-4396-8d5f-8c081fb06d67",
  "published": "2024-10-21T13:15:05.467",
  "lastModified": "2024-10-22T15:46:38.027",
  "vulnStatus": "Analyzed",
  "descriptions": [
    {
      "lang": "en",
      "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nnvdimm: Fix devs leaks in scan_labels()\n\nscan_labels() leaks memory when label scanning fails and it falls back\nto just creating a default \"seed\" namespace for userspace to configure.\nRoot can force the kernel to leak memory.\n\nAllocate the minimum resources unconditionally and release them when\nunneeded to avoid the memory leak.\n\nA kmemleak reports:\nunreferenced object 0xffff88800dda1980 (size 16):\n  comm \"kworker/u10:5\", pid 69, jiffies 4294671781\n  hex dump (first 16 bytes):\n    00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................\n  backtrace (crc 0):\n    [\u003c00000000c5dea560\u003e] __kmalloc+0x32c/0x470\n    [\u003c000000009ed43c83\u003e] nd_region_register_namespaces+0x6fb/0x1120 [libnvdimm]\n    [\u003c000000000e07a65c\u003e] nd_region_probe+0xfe/0x210 [libnvdimm]\n    [\u003c000000007b79ce5f\u003e] nvdimm_bus_probe+0x7a/0x1e0 [libnvdimm]\n    [\u003c00000000a5f3da2e\u003e] really_probe+0xc6/0x390\n    [\u003c00000000129e2a69\u003e] __driver_probe_device+0x78/0x150\n    [\u003c000000002dfed28b\u003e] driver_probe_device+0x1e/0x90\n    [\u003c00000000e7048de2\u003e] __device_attach_driver+0x85/0x110\n    [\u003c0000000032dca295\u003e] bus_for_each_drv+0x85/0xe0\n    [\u003c00000000391c5a7d\u003e] __device_attach+0xbe/0x1e0\n    [\u003c0000000026dabec0\u003e] bus_probe_device+0x94/0xb0\n    [\u003c00000000c590d936\u003e] device_add+0x656/0x870\n    [\u003c000000003d69bfaa\u003e] nd_async_device_register+0xe/0x50 [libnvdimm]\n    [\u003c000000003f4c52a4\u003e] async_run_entry_fn+0x2e/0x110\n    [\u003c00000000e201f4b0\u003e] process_one_work+0x1ee/0x600\n    [\u003c000000006d90d5a9\u003e] worker_thread+0x183/0x350"
    },
    {
      "lang": "es",
      "value": "En el kernel de Linux, se ha resuelto la siguiente vulnerabilidad: nvdimm: Se corrigen las fugas de memoria de los desarrolladores en scan_labels() scan_labels() pierde memoria cuando falla el escaneo de etiquetas y vuelve a crear un espacio de nombres \"seed\" predeterminado para que el espacio de usuario lo configure. El usuario root puede obligar al kernel a perder memoria. Asigne los recursos mínimos incondicionalmente y libérelos cuando no sean necesarios para evitar la fuga de memoria. Un kmemleak informa: objeto no referenciado 0xffff88800dda1980 (tamaño 16): comm \"kworker/u10:5\", pid 69, jiffies 4294671781 volcado hexadecimal (primeros 16 bytes): 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................ backtrace (crc 0): [\u0026lt;00000000c5dea560\u0026gt;] __kmalloc+0x32c/0x470 [\u0026lt;000000009ed43c83\u0026gt;] nd_region_register_namespaces+0x6fb/0x1120 [libnvdimm] [\u0026lt;000000000e07a65c\u0026gt;] nd_region_probe+0xfe/0x210 [libnvdimm] [\u0026lt;000000007b79ce5f\u0026gt;] nvdimm_bus_probe+0x7a/0x1e0 [libnvdimm] [\u0026lt;00000000a5f3da2e\u0026gt;] really_probe+0xc6/0x390 [\u0026lt;00000000129e2a69\u0026gt;] __driver_probe_device+0x78/0x150 [\u0026lt;000000002dfed28b\u0026gt;] driver_probe_device+0x1e/0x90 [\u0026lt;00000000e7048de2\u0026gt;] __device_attach_driver+0x85/0x110 [\u0026lt;0000000032dca295\u0026gt;] bus_for_each_drv+0x85/0xe0 [\u0026lt;00000000391c5a7d\u0026gt;] __device_attach+0xbe/0x1e0 [\u0026lt;0000000026dabec0\u0026gt;] bus_probe_device+0x94/0xb0 [\u0026lt;00000000c590d936\u0026gt;] device_add+0x656/0x870 [\u0026lt;000000003d69bfaa\u0026gt;] nd_async_device_register+0xe/0x50 [libnvdimm] [\u0026lt;000000003f4c52a4\u0026gt;] async_run_entry_fn+0x2e/0x110 [\u0026lt;00000000e201f4b0\u0026gt;] process_one_work+0x1ee/0x600 [\u0026lt;000000006d90d5a9\u0026gt;] worker_thread+0x183/0x350"
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H",
          "attackVector": "LOCAL",
          "attackComplexity": "LOW",
          "privilegesRequired": "LOW",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "NONE",
          "integrityImpact": "NONE",
          "availabilityImpact": "HIGH",
          "baseScore": 5.5,
          "baseSeverity": "MEDIUM"
        },
        "exploitabilityScore": 1.8,
        "impactScore": 3.6
      }
    ]
  },
  "weaknesses": [
    {
      "source": "nvd@nist.gov",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-401"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
              "matchCriteriaId": "8102F9FA-E460-401D-B624-0C10DE09E53F",
              "versionStartIncluding": "4.2",
              "versionEndExcluding": "6.1.113"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
              "matchCriteriaId": "D448821D-C085-4CAF-88FA-2DDE7BE21976",
              "versionStartIncluding": "6.2",
              "versionEndExcluding": "6.6.54"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
              "matchCriteriaId": "CE94BB8D-B0AB-4563-9ED7-A12122B56EBE",
              "versionStartIncluding": "6.7",
              "versionEndExcluding": "6.10.13"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
              "matchCriteriaId": "AB755D26-97F4-43B6-8604-CD076811E181",
              "versionStartIncluding": "6.11",
              "versionEndExcluding": "6.11.2"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://git.kernel.org/stable/c/18a672c62d735744c6340eb3f5e58934a5d34cf2",
      "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://git.kernel.org/stable/c/45db20bdb5695d06478d35e05fb2550441bed890",
      "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://git.kernel.org/stable/c/62c2aa6b1f565d2fc1ec11a6e9e8336ce37a6426",
      "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://git.kernel.org/stable/c/939053737edb49ba5bdc5846acb45f11d15b7ab4",
      "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://git.kernel.org/stable/c/cdf0dfb3d183bbe0d0b6a6622c53d105074ad384",
      "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67",
      "tags": [
        "Patch"
      ]
    }
  ]
}