{
  "id": "CVE-2024-43790",
  "sourceIdentifier": "security-advisories@github.com",
  "published": "2024-08-22T22:15:05.317",
  "lastModified": "2024-08-23T16:18:28.547",
  "vulnStatus": "Awaiting Analysis",
  "descriptions": [
    {
      "lang": "en",
      "value": "Vim is an open source command line text editor. When performing a search and displaying the search-count message is disabled (:set shm+=S), the search pattern is displayed at the bottom of the screen in a buffer (msgbuf). When right-left mode (:set rl) is enabled, the search pattern is reversed. This happens by allocating a new buffer. If the search pattern contains some ASCII NUL characters, the buffer allocated will be smaller than the original allocated buffer (because for allocating the reversed buffer, the strlen() function is called, which only counts until it notices an ASCII NUL byte ) and thus the original length indicator is wrong. This causes an overflow when accessing characters inside the msgbuf by the previously (now wrong) length of the msgbuf. The issue has been fixed as of Vim patch v9.1.0689."
    },
    {
      "lang": "es",
      "value": "Vim es un editor de texto de línea de comandos de código abierto. Cuando se realiza una búsqueda y se deshabilita la visualización del mensaje de recuento de búsqueda (:set shm+=S), el patrón de búsqueda se muestra en la parte inferior de la pantalla en un búfer (msgbuf). Cuando el modo derecha-izquierda (:set rl) está habilitado, el patrón de búsqueda se invierte. Esto sucede asignando un nuevo búfer. Si el patrón de búsqueda contiene algunos caracteres ASCII NUL, el búfer asignado será más pequeño que el búfer asignado original (porque para asignar el búfer invertido, se llama a la función strlen(), que solo cuenta hasta que detecta un byte ASCII NUL) y por lo tanto el indicador de longitud original es incorrecto. Esto provoca un desbordamiento al acceder a caracteres dentro del msgbuf por la longitud anterior (ahora incorrecta) del msgbuf. El problema se solucionó a partir del parche Vim v9.1.0689."
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "security-advisories@github.com",
        "type": "Secondary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:L/AC:H/PR:N/UI:R/S:U/C:L/I:L/A:L",
          "attackVector": "LOCAL",
          "attackComplexity": "HIGH",
          "privilegesRequired": "NONE",
          "userInteraction": "REQUIRED",
          "scope": "UNCHANGED",
          "confidentialityImpact": "LOW",
          "integrityImpact": "LOW",
          "availabilityImpact": "LOW",
          "baseScore": 4.5,
          "baseSeverity": "MEDIUM"
        },
        "exploitabilityScore": 1,
        "impactScore": 3.4
      }
    ]
  },
  "weaknesses": [
    {
      "source": "security-advisories@github.com",
      "type": "Secondary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-122"
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://github.com/vim/vim/commit/cacb6693c10bb19f28a50eca47bc",
      "source": "security-advisories@github.com"
    },
    {
      "url": "https://github.com/vim/vim/security/advisories/GHSA-v2x2-cjcg-f9jm",
      "source": "security-advisories@github.com"
    }
  ]
}