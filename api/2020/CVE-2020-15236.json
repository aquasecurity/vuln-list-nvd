{
  "id": "CVE-2020-15236",
  "sourceIdentifier": "security-advisories@github.com",
  "published": "2020-10-05T15:15:12.047",
  "lastModified": "2020-10-09T17:06:03.947",
  "vulnStatus": "Analyzed",
  "descriptions": [
    {
      "lang": "en",
      "value": "In Wiki.js before version 2.5.151, directory traversal outside of Wiki.js context is possible when a storage module with local asset cache fetching is enabled. A malicious user can potentially read any file on the file system by crafting a special URL that allows for directory traversal. This is only possible when a storage module implementing local asset cache (e.g Local File System or Git) is enabled and that no web application firewall solution (e.g. cloudflare) strips potentially malicious URLs. Commit 084dcd69d1591586ee4752101e675d5f0ac6dcdc fixes this vulnerability by sanitizing the path before it is passed on to the storage module. The sanitization step removes any directory traversal (e.g. `..` and `.`) sequences as well as invalid filesystem characters from the path. As a workaround, disable any storage module with local asset caching capabilities such as Local File System and Git."
    },
    {
      "lang": "es",
      "value": "En Wiki.js versiones anteriores a 2.5.151, el salto de directorio fuera del contexto de Wiki.js es posible cuando es habilitado un módulo de almacenamiento con una extracción de caché de activo local.\u0026#xa0;Un usuario malicioso puede leer potencialmente cualquier archivo en el sistema de archivos diseñando una URL especial que permita un salto de directorio.\u0026#xa0;Esto solo es posible cuando un módulo de almacenamiento que implementa la caché de activos local (por ejemplo, Local File System o Git) está habilitado y ninguna corrección de firewall de aplicaciones web (por ejemplo, cloudflare) elimina las URL potencialmente maliciosas.\u0026#xa0;Commit 084dcd69d1591586ee4752101e675d5f0ac6dcdc corrige esta vulnerabilidad saneando la ruta antes de pasarla hacia el módulo de almacenamiento.\u0026#xa0;El paso del saneamiento elimina cualquier secuencia de salto de directorio (por ejemplo, \"..\" y \".\"), así como los caracteres del sistema de archivos no válidos de la ruta.\u0026#xa0;Como solución alternativa, deshabilitar cualquier módulo de almacenamiento con capacidades de hacer cache de activos locales como el Local File System o Git"
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "NONE",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "NONE",
          "availabilityImpact": "NONE",
          "baseScore": 7.5,
          "baseSeverity": "HIGH"
        },
        "exploitabilityScore": 3.9,
        "impactScore": 3.6
      },
      {
        "source": "security-advisories@github.com",
        "type": "Secondary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:N/A:N",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "NONE",
          "userInteraction": "NONE",
          "scope": "CHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "NONE",
          "availabilityImpact": "NONE",
          "baseScore": 8.6,
          "baseSeverity": "HIGH"
        },
        "exploitabilityScore": 3.9,
        "impactScore": 4
      }
    ],
    "cvssMetricV2": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "2.0",
          "vectorString": "AV:N/AC:L/Au:N/C:P/I:N/A:N",
          "accessVector": "NETWORK",
          "accessComplexity": "LOW",
          "authentication": "NONE",
          "confidentialityImpact": "PARTIAL",
          "integrityImpact": "NONE",
          "availabilityImpact": "NONE",
          "baseScore": 5
        },
        "baseSeverity": "MEDIUM",
        "exploitabilityScore": 10,
        "impactScore": 2.9,
        "acInsufInfo": false,
        "obtainAllPrivilege": false,
        "obtainUserPrivilege": false,
        "obtainOtherPrivilege": false,
        "userInteractionRequired": false
      }
    ]
  },
  "weaknesses": [
    {
      "source": "security-advisories@github.com",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-22"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:requarks:wiki.js:*:*:*:*:*:*:*:*",
              "matchCriteriaId": "648B7617-D52A-4CF4-8081-6A5E7C49415A",
              "versionStartIncluding": "2.5.80",
              "versionEndExcluding": "2.5.151"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://github.com/Requarks/wiki/commit/084dcd69d1591586ee4752101e675d5f0ac6dcdc",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/Requarks/wiki/security/advisories/GHSA-whpv-5xg2-w527",
      "source": "security-advisories@github.com",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ]
}