{
  "id": "CVE-2023-45822",
  "sourceIdentifier": "security-advisories@github.com",
  "published": "2023-10-19T21:15:08.930",
  "lastModified": "2023-10-30T15:37:49.727",
  "vulnStatus": "Analyzed",
  "descriptions": [
    {
      "lang": "en",
      "value": "Artifact Hub is a web-based application that enables finding, installing, and publishing packages and configurations for CNCF projects. During a security audit of Artifact Hub's code base a security researcher identified a bug in which a default unsafe rego built-in was allowed to be used when defining authorization policies. Artifact Hub includes a fine-grained authorization mechanism that allows organizations to define what actions can be performed by their members. It is based on customizable authorization policies that are enforced by the `Open Policy Agent`. Policies are written using `rego` and their data files are expected to be json documents. By default, `rego` allows policies to make HTTP requests, which can be abused to send requests to internal resources and forward the responses to an external entity. In the context of Artifact Hub, this capability should have been disabled. This issue has been resolved in version `1.16.0`. Users are advised to upgrade. There are no known workarounds for this vulnerability."
    },
    {
      "lang": "es",
      "value": "Artifact Hub es una aplicación basada en web que permite buscar, instalar y publicar paquetes y configuraciones para proyectos CNCF. Durante una auditoría de seguridad del código base de Artifact Hub, un investigador de seguridad identificó un error en el que se permitía el uso de un rego incorporado predeterminado no seguro al definir políticas de autorización. Artifact Hub incluye un mecanismo de autorización detallado que permite a las organizaciones definir qué acciones pueden realizar sus miembros. Se basa en políticas de autorización personalizables que aplica el \"Open Policy Agent\". Las políticas se escriben utilizando `rego` y se espera que sus archivos de datos sean documentos json. De forma predeterminada, `rego` permite que las políticas realicen solicitudes HTTP, de las cuales se puede abusar para enviar solicitudes a recursos internos y reenviar las respuestas a una entidad externa. En el contexto de Artifact Hub, esta capacidad debería haberse deshabilitado. Este problema se resolvió en la versión `1.16.0`. Se recomienda a los usuarios que actualicen. No se conocen workarounds para esta vulnerabilidad."
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "NONE",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "LOW",
          "integrityImpact": "NONE",
          "availabilityImpact": "NONE",
          "baseScore": 5.3,
          "baseSeverity": "MEDIUM"
        },
        "exploitabilityScore": 3.9,
        "impactScore": 1.4
      },
      {
        "source": "security-advisories@github.com",
        "type": "Secondary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:N/A:N",
          "attackVector": "NETWORK",
          "attackComplexity": "HIGH",
          "privilegesRequired": "NONE",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "LOW",
          "integrityImpact": "NONE",
          "availabilityImpact": "NONE",
          "baseScore": 3.7,
          "baseSeverity": "LOW"
        },
        "exploitabilityScore": 2.2,
        "impactScore": 1.4
      }
    ]
  },
  "weaknesses": [
    {
      "source": "nvd@nist.gov",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-918"
        }
      ]
    },
    {
      "source": "security-advisories@github.com",
      "type": "Secondary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-918"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:artifacthub:hub:*:*:*:*:*:*:*:*",
              "matchCriteriaId": "19535757-82CE-47EA-B827-0273894CF9BD",
              "versionEndExcluding": "1.16.0"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://artifacthub.io/packages/helm/artifact-hub/artifact-hub?modal=changelog\u0026version=1.16.0",
      "source": "security-advisories@github.com",
      "tags": [
        "Product"
      ]
    },
    {
      "url": "https://github.com/artifacthub/hub/security/advisories/GHSA-9pc8-m4vp-ggvf",
      "source": "security-advisories@github.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.openpolicyagent.org/",
      "source": "security-advisories@github.com",
      "tags": [
        "Mitigation"
      ]
    },
    {
      "url": "https://www.openpolicyagent.org/docs/latest/#rego",
      "source": "security-advisories@github.com",
      "tags": [
        "Mitigation"
      ]
    }
  ]
}