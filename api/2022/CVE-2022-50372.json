{
  "id": "CVE-2022-50372",
  "sourceIdentifier": "416baaa9-dc9f-4396-8d5f-8c081fb06d67",
  "published": "2025-09-17T15:15:36.187",
  "lastModified": "2025-09-17T15:15:36.187",
  "vulnStatus": "Received",
  "descriptions": [
    {
      "lang": "en",
      "value": "In the Linux kernel, the following vulnerability has been resolved:\n\ncifs: Fix memory leak when build ntlmssp negotiate blob failed\n\nThere is a memory leak when mount cifs:\n  unreferenced object 0xffff888166059600 (size 448):\n    comm \"mount.cifs\", pid 51391, jiffies 4295596373 (age 330.596s)\n    hex dump (first 32 bytes):\n      fe 53 4d 42 40 00 00 00 00 00 00 00 01 00 82 00  .SMB@...........\n      00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................\n    backtrace:\n      [\u003c0000000060609a61\u003e] mempool_alloc+0xe1/0x260\n      [\u003c00000000adfa6c63\u003e] cifs_small_buf_get+0x24/0x60\n      [\u003c00000000ebb404c7\u003e] __smb2_plain_req_init+0x32/0x460\n      [\u003c00000000bcf875b4\u003e] SMB2_sess_alloc_buffer+0xa4/0x3f0\n      [\u003c00000000753a2987\u003e] SMB2_sess_auth_rawntlmssp_negotiate+0xf5/0x480\n      [\u003c00000000f0c1f4f9\u003e] SMB2_sess_setup+0x253/0x410\n      [\u003c00000000a8b83303\u003e] cifs_setup_session+0x18f/0x4c0\n      [\u003c00000000854bd16d\u003e] cifs_get_smb_ses+0xae7/0x13c0\n      [\u003c000000006cbc43d9\u003e] mount_get_conns+0x7a/0x730\n      [\u003c000000005922d816\u003e] cifs_mount+0x103/0xd10\n      [\u003c00000000e33def3b\u003e] cifs_smb3_do_mount+0x1dd/0xc90\n      [\u003c0000000078034979\u003e] smb3_get_tree+0x1d5/0x300\n      [\u003c000000004371f980\u003e] vfs_get_tree+0x41/0xf0\n      [\u003c00000000b670d8a7\u003e] path_mount+0x9b3/0xdd0\n      [\u003c000000005e839a7d\u003e] __x64_sys_mount+0x190/0x1d0\n      [\u003c000000009404c3b9\u003e] do_syscall_64+0x35/0x80\n\nWhen build ntlmssp negotiate blob failed, the session setup request\nshould be freed."
    }
  ],
  "metrics": {},
  "references": [
    {
      "url": "https://git.kernel.org/stable/c/30b2d7f8f13664655480d6af45f60270b3eb6736",
      "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"
    },
    {
      "url": "https://git.kernel.org/stable/c/fa5a70bdd5e565c8696fb04dfe18a4e8aff4695d",
      "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"
    }
  ]
}