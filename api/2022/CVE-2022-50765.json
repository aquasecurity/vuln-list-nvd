{
  "id": "CVE-2022-50765",
  "sourceIdentifier": "416baaa9-dc9f-4396-8d5f-8c081fb06d67",
  "published": "2025-12-24T13:16:03.297",
  "lastModified": "2025-12-24T13:16:03.297",
  "vulnStatus": "Received",
  "descriptions": [
    {
      "lang": "en",
      "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nRISC-V: kexec: Fix memory leak of elf header buffer\n\nThis is reported by kmemleak detector:\n\nunreferenced object 0xff2000000403d000 (size 4096):\n  comm \"kexec\", pid 146, jiffies 4294900633 (age 64.792s)\n  hex dump (first 32 bytes):\n    7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00  .ELF............\n    04 00 f3 00 01 00 00 00 00 00 00 00 00 00 00 00  ................\n  backtrace:\n    [\u003c00000000566ca97c\u003e] kmemleak_vmalloc+0x3c/0xbe\n    [\u003c00000000979283d8\u003e] __vmalloc_node_range+0x3ac/0x560\n    [\u003c00000000b4b3712a\u003e] __vmalloc_node+0x56/0x62\n    [\u003c00000000854f75e2\u003e] vzalloc+0x2c/0x34\n    [\u003c00000000e9a00db9\u003e] crash_prepare_elf64_headers+0x80/0x30c\n    [\u003c0000000067e8bf48\u003e] elf_kexec_load+0x3e8/0x4ec\n    [\u003c0000000036548e09\u003e] kexec_image_load_default+0x40/0x4c\n    [\u003c0000000079fbe1b4\u003e] sys_kexec_file_load+0x1c4/0x322\n    [\u003c0000000040c62c03\u003e] ret_from_syscall+0x0/0x2\n\nIn elf_kexec_load(), a buffer is allocated via vzalloc() to store elf\nheaders.  While it's not freed back to system when kdump kernel is\nreloaded or unloaded, or when image-\u003eelf_header is successfully set and\nthen fails to load kdump kernel for some reason. Fix it by freeing the\nbuffer in arch_kimage_file_post_load_cleanup()."
    }
  ],
  "metrics": {},
  "references": [
    {
      "url": "https://git.kernel.org/stable/c/090bfcfc9f14d05154893c67eeaecc56e894fbae",
      "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"
    },
    {
      "url": "https://git.kernel.org/stable/c/cbc32023ddbdf4baa3d9dc513a2184a84080a5a2",
      "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"
    },
    {
      "url": "https://git.kernel.org/stable/c/cdea2da6787583ecca43594132533a2ac8d7cd21",
      "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"
    }
  ]
}