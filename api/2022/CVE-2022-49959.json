{
  "id": "CVE-2022-49959",
  "sourceIdentifier": "416baaa9-dc9f-4396-8d5f-8c081fb06d67",
  "published": "2025-06-18T11:15:23.127",
  "lastModified": "2025-11-14T18:09:58.837",
  "vulnStatus": "Analyzed",
  "descriptions": [
    {
      "lang": "en",
      "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nopenvswitch: fix memory leak at failed datapath creation\n\novs_dp_cmd_new()-\u003eovs_dp_change()-\u003eovs_dp_set_upcall_portids()\nallocates array via kmalloc.\nIf for some reason new_vport() fails during ovs_dp_cmd_new()\ndp-\u003eupcall_portids must be freed.\nAdd missing kfree.\n\nKmemleak example:\nunreferenced object 0xffff88800c382500 (size 64):\n  comm \"dump_state\", pid 323, jiffies 4294955418 (age 104.347s)\n  hex dump (first 32 bytes):\n    5e c2 79 e4 1f 7a 38 c7 09 21 38 0c 80 88 ff ff  ^.y..z8..!8.....\n    03 00 00 00 0a 00 00 00 14 00 00 00 28 00 00 00  ............(...\n  backtrace:\n    [\u003c0000000071bebc9f\u003e] ovs_dp_set_upcall_portids+0x38/0xa0\n    [\u003c000000000187d8bd\u003e] ovs_dp_change+0x63/0xe0\n    [\u003c000000002397e446\u003e] ovs_dp_cmd_new+0x1f0/0x380\n    [\u003c00000000aa06f36e\u003e] genl_family_rcv_msg_doit+0xea/0x150\n    [\u003c000000008f583bc4\u003e] genl_rcv_msg+0xdc/0x1e0\n    [\u003c00000000fa10e377\u003e] netlink_rcv_skb+0x50/0x100\n    [\u003c000000004959cece\u003e] genl_rcv+0x24/0x40\n    [\u003c000000004699ac7f\u003e] netlink_unicast+0x23e/0x360\n    [\u003c00000000c153573e\u003e] netlink_sendmsg+0x24e/0x4b0\n    [\u003c000000006f4aa380\u003e] sock_sendmsg+0x62/0x70\n    [\u003c00000000d0068654\u003e] ____sys_sendmsg+0x230/0x270\n    [\u003c0000000012dacf7d\u003e] ___sys_sendmsg+0x88/0xd0\n    [\u003c0000000011776020\u003e] __sys_sendmsg+0x59/0xa0\n    [\u003c000000002e8f2dc1\u003e] do_syscall_64+0x3b/0x90\n    [\u003c000000003243e7cb\u003e] entry_SYSCALL_64_after_hwframe+0x63/0xcd"
    },
    {
      "lang": "es",
      "value": "En el kernel de Linux, se ha resuelto la siguiente vulnerabilidad: openvswitch: se corrige una fuga de memoria al crear una ruta de datos fallida. ovs_dp_cmd_new()-\u0026gt;ovs_dp_change()-\u0026gt;ovs_dp_set_upcall_portids() asigna una matriz mediante kmalloc. Si por alguna razón new_vport() falla durante ovs_dp_cmd_new(), se debe liberar dp-\u0026gt;upcall_portids. Se añade la falta de kfree. Ejemplo de Kmemleak: objeto sin referencia 0xffff88800c382500 (tamaño 64): comm \"dump_state\", pid 323, jiffies 4294955418 (edad 104.347s) volcado hexadecimal (primeros 32 bytes): 5e c2 79 e4 1f 7a 38 c7 09 21 38 0c 80 88 ff ff ^.y..z8..!8..... 03 00 00 00 0a 00 00 00 14 00 00 00 28 00 00 00 ............(...  backtrace: [\u0026lt;0000000071bebc9f\u0026gt;] ovs_dp_set_upcall_portids+0x38/0xa0 [\u0026lt;000000000187d8bd\u0026gt;] ovs_dp_change+0x63/0xe0 [\u0026lt;000000002397e446\u0026gt;] ovs_dp_cmd_new+0x1f0/0x380 [\u0026lt;00000000aa06f36e\u0026gt;] genl_family_rcv_msg_doit+0xea/0x150 [\u0026lt;000000008f583bc4\u0026gt;] genl_rcv_msg+0xdc/0x1e0 [\u0026lt;00000000fa10e377\u0026gt;] netlink_rcv_skb+0x50/0x100 [\u0026lt;000000004959cece\u0026gt;] genl_rcv+0x24/0x40 [\u0026lt;000000004699ac7f\u0026gt;] netlink_unicast+0x23e/0x360 [\u0026lt;00000000c153573e\u0026gt;] netlink_sendmsg+0x24e/0x4b0 [\u0026lt;000000006f4aa380\u0026gt;] sock_sendmsg+0x62/0x70 [\u0026lt;00000000d0068654\u0026gt;] ____sys_sendmsg+0x230/0x270 [\u0026lt;0000000012dacf7d\u0026gt;] ___sys_sendmsg+0x88/0xd0 [\u0026lt;0000000011776020\u0026gt;] __sys_sendmsg+0x59/0xa0 [\u0026lt;000000002e8f2dc1\u0026gt;] do_syscall_64+0x3b/0x90 [\u0026lt;000000003243e7cb\u0026gt;] entry_SYSCALL_64_after_hwframe+0x63/0xcd "
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H",
          "attackVector": "LOCAL",
          "attackComplexity": "LOW",
          "privilegesRequired": "LOW",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "NONE",
          "integrityImpact": "NONE",
          "availabilityImpact": "HIGH",
          "baseScore": 5.5,
          "baseSeverity": "MEDIUM"
        },
        "exploitabilityScore": 1.8,
        "impactScore": 3.6
      }
    ]
  },
  "weaknesses": [
    {
      "source": "nvd@nist.gov",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-401"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
              "matchCriteriaId": "92264A00-0618-4F99-926E-A01E06AFEBEC",
              "versionStartIncluding": "5.15",
              "versionEndExcluding": "5.15.66"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
              "matchCriteriaId": "7FEC7656-4CE2-424C-8830-EDB160E701C8",
              "versionStartIncluding": "5.16",
              "versionEndExcluding": "5.19.8"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:o:linux:linux_kernel:6.0:rc1:*:*:*:*:*:*",
              "matchCriteriaId": "E8BD11A3-8643-49B6-BADE-5029A0117325"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:o:linux:linux_kernel:6.0:rc2:*:*:*:*:*:*",
              "matchCriteriaId": "5F0AD220-F6A9-4012-8636-155F1B841FAD"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:o:linux:linux_kernel:6.0:rc3:*:*:*:*:*:*",
              "matchCriteriaId": "A46498B3-78E1-4623-AAE1-94D29A42BE4E"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://git.kernel.org/stable/c/a87406f4adee9c53b311d8a1ba2849c69e29a6d0",
      "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://git.kernel.org/stable/c/c0c1c0241917459644326a1a3102207c871ae159",
      "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://git.kernel.org/stable/c/ca54b2bfaab385778e55a9fd33f6c31e7f743b48",
      "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67",
      "tags": [
        "Patch"
      ]
    }
  ]
}