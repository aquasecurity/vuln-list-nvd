{
  "id": "CVE-2021-36804",
  "sourceIdentifier": "cve@rapid7.con",
  "published": "2021-08-04T23:15:08.243",
  "lastModified": "2021-08-13T13:30:32.623",
  "vulnStatus": "Analyzed",
  "descriptions": [
    {
      "lang": "en",
      "value": "Akaunting version 2.1.12 and earlier suffers from a password reset spoofing vulnerability, wherein an attacker can proxy password reset requests through a running Akaunting instance, if that attacker knows the target's e-mail address. This issue was fixed in version 2.1.13 of the product. Please note that this issue is ultimately caused by the defaults provided by the Laravel framework, specifically how proxy headers are handled with respect to multi-tenant implementations. In other words, while this is not technically a vulnerability in Laravel, this default configuration is very likely to lead to practically identical identical vulnerabilities in Laravel projects that implement multi-tenant applications."
    },
    {
      "lang": "es",
      "value": "Akaunting versiones 2.1.12 y anteriores, sufren de una vulnerabilidad de suplantación de restablecimiento de contraseña, donde un atacante puede delegar peticiones de restablecimiento de contraseña mediante una instancia de Akaunting en ejecución, si ese atacante conoce la dirección de correo electrónico del objetivo. Este problema se ha corregido en la versión 2.1.13 del producto. Tenga en cuenta que este problema es causado en última instancia por los valores predeterminados proporcionados por el marco de Laravel, específicamente cómo se manejan los encabezados de proxy con respecto a las implementaciones multi-tenant. En otras palabras, mientras que esto no es técnicamente una vulnerabilidad en Laravel, esta configuración predeterminada es muy probable que conlleve a vulnerabilidades prácticamente idénticas en proyectos de Laravel que implementen aplicaciones multi-tenant"
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:N",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "NONE",
          "userInteraction": "REQUIRED",
          "scope": "UNCHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "HIGH",
          "availabilityImpact": "NONE",
          "baseScore": 8.1,
          "baseSeverity": "HIGH"
        },
        "exploitabilityScore": 2.8,
        "impactScore": 5.2
      },
      {
        "source": "cve@rapid7.con",
        "type": "Secondary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:L/I:L/A:N",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "NONE",
          "userInteraction": "REQUIRED",
          "scope": "UNCHANGED",
          "confidentialityImpact": "LOW",
          "integrityImpact": "LOW",
          "availabilityImpact": "NONE",
          "baseScore": 5.4,
          "baseSeverity": "MEDIUM"
        },
        "exploitabilityScore": 2.8,
        "impactScore": 2.5
      }
    ],
    "cvssMetricV2": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "2.0",
          "vectorString": "AV:N/AC:M/Au:N/C:P/I:P/A:N",
          "accessVector": "NETWORK",
          "accessComplexity": "MEDIUM",
          "authentication": "NONE",
          "confidentialityImpact": "PARTIAL",
          "integrityImpact": "PARTIAL",
          "availabilityImpact": "NONE",
          "baseScore": 5.8
        },
        "baseSeverity": "MEDIUM",
        "exploitabilityScore": 8.6,
        "impactScore": 4.9,
        "acInsufInfo": false,
        "obtainAllPrivilege": false,
        "obtainUserPrivilege": false,
        "obtainOtherPrivilege": false,
        "userInteractionRequired": true
      }
    ]
  },
  "weaknesses": [
    {
      "source": "nvd@nist.gov",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-640"
        }
      ]
    },
    {
      "source": "cve@rapid7.con",
      "type": "Secondary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-640"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:akaunting:akaunting:*:*:*:*:*:*:*:*",
              "matchCriteriaId": "1C0E3BA7-1D63-44C7-B536-A68FB76A3126",
              "versionEndExcluding": "2.1.13"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://github.com/laravel/laravel/pull/5477",
      "source": "cve@rapid7.con",
      "tags": [
        "Issue Tracking",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.laravel-enlightn.com/docs/security/host-injection-analyzer.html",
      "source": "cve@rapid7.con",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.rapid7.com/blog/post/2021/07/27/multiple-open-source-web-app-vulnerabilities-fixed/",
      "source": "cve@rapid7.con",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    }
  ]
}